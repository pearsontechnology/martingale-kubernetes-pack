$type: HeaderPage
props:
  title:
    $map: '`${params.namespace} - Deployments`'
children:
  $type: Panel
  children:
    $type: Provider
    props:
      provide:
        data:
          url:
            $map: >-
              (params.env?`/api/${params.env}/kube`:"/api/kube")+`/apis/extensions/v1beta1/namespaces/${params.namespace}/deployments`
          root: items
          mapper:
            $mapper: |-
              props.map((ds)=>{
                const md = ds.metadata;
                return {
                  baseLink: params.env?`/kubernetes/${params.env}`:'/kubernetes',
                  name: md.name,
                  namespace: md.namespace,
                  created: md.creationTimestamp,
                  labels: md.labels
                };
              })
      Component:
        $component: ActionTable
      props:
        suppress:
          - baseLink
        actions:
          - link:
              $mapper: >-
                `${props.baseLink}/namespace/${params.namespace}/deployment/${props.name}${extractQueryParams(['apiBase'])}`
            caption: Details
            btnStyle: primary
          - delete:
              $mapper: >-
                (params.env?`/api/${params.env}/kube`:"/api/kube")+`/apis/extensions/v1beta1/namespaces/${params.namespace}/deployments/${props.name}`
            caption: Delete
            message: 'Are you sure you want to delete ${name}?'
paths:
  - /kubernetes/namespace/:namespace/deployments
  - /kubernetes/:env/namespace/:namespace/deployments
